<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.5.0 -->
<title>SReachPoint.m | SReachTools</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="SReachPoint.m" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Solve the problem of stochastic reachability of a target tube from a given initial state using a host of techniques ============================================================================= SReachPoint can (approximately) solve the problem of stochastic reachability of a target tube from a given initial state, maximize Prob( \cap_{i=1}^N x_t lies in Safe_t) subject to dynamics and bounds on control This function can compute an underapproximation to the optimal value of the above problem as well as synthesize controllers: 1. open-loop controller that satisfies the prespecified hard control bounds, 2. affine disturbance feedback controller that satisfies the hard control bounds with a likelihood above the user-specified threshold. This function is a compilation of various techniques proposed in the literature. The problem of stochastic reachability of a target tube is discussed in A. Vinod and M. Oishi, &quot;Stochastic reachability of a target tube: Theory and computation,&quot; IEEE Transactions in Automatic Control, 2018 (submitted) URL: https://arxiv.org/pdf/1810.05217.pdf. It subsumes the terminal hitting-time stochastic reach-avoid problem (Summers and Lygeros, Automatica, 2010) as well as the stochastic viability problem (Abate et. al, Automatica, 2008). This function is a compilation of various techniques proposed in the literature: 1. Convex chance-constrained-based approach (chance-open): High-level desc. : Use Boole&#39;s inequality, Gaussian random vector, and piecewise linear approximation of the inverse of the standard normal cumulative density function to create a linear program-based approximation to the original optimization Approximation : Guaranteed underapproximation Controller type : Open-loop controller that satisfies the hard input bounds Optimality : Optimal open-loop controller for the underapproximation problem due to convexity guarantees SReachTool function: SReachPointCcO Dependency (EXT) : CVX Paper : a. K. Lesser, M. Oishi, and R. Erwin, &quot;Stochastic reachability for control of spacecraft relative motion,&quot; In Proc. IEEE Conf. Dec. &amp; Ctrl., 2013. b. A. Vinod and M. Oishi. Affine controller synthesis for stochastic reachability via difference of convex programming. In Proc. Conf. of Dec. &amp; Ctrl., 2019. (submitted). https://hscl.unm.edu/affinecontrollersynthesis/ 2. Difference-of-convex chance-constrained-based approach (chance-affine): High-level desc. : Use Boole&#39;s inequality, Gaussian random vector, hyperbolic constraints-to-second order cone constraint reformulation, and piecewise linear approximation of the inverse of the standard normal cumulative density function to create a second-order cone program-based difference-of-convex optimization problem Controller type : A history-dependent affine controller that satisfies softened input constraints (controller satisfies the hard input bounds upto a user-specified probabilistic threshold) Optimality : Suboptimal affine controller for the underapproximation problem due to non-convexity established by the difference of convex formulation Approximation : Guaranteed underapproximation SReachTool function: SReachPointCcA Dependency (EXT) : CVX Paper : A. Vinod and M. Oishi. Affine controller synthesis for stochastic reachability via difference of convex programming. In Proc. Conf. of Dec. &amp; Ctrl., 2019. (submitted). https://hscl.unm.edu/affinecontrollersynthesis/ 3. Uniform risk allocation-based approach (chance-affine-uni): High-level desc. : Use Boole&#39;s inequality, Gaussian random vector, hyperbolic constraints-to-second order cone constraint reformulation. By decoupling the risk allocation from controller synthesis, this approach solves a series of SOCP problems guided by a bisection on the uniform risk allocation (See Notes) Controller type : A history-dependent affine controller that satisfies softened input constraints (controller satisfies the hard input bounds upto a user-specified probabilistic threshold) Optimality : Suboptimal affine controller for the underapproximation problem Approximation : Guaranteed underapproximation SReachTool function: SReachPointCcAu Dependency (EXT) : CVX Paper : 1) M. Vitus and C. Tomlin, &quot;On feedback design and risk allocation in chance constrained control&quot;, In Proc. Conf. Dec. &amp; Ctrl., 2011. 2) A. Vinod and M. Oishi. Affine controller synthesis for stochastic reachability via difference of convex programming. In Proc. Conf. of Dec. &amp; Ctrl., 2019 (submitted). https://hscl.unm.edu/affinecontrollersynthesis/ 4. Fourier transform + Patternsearch (genzps-open): High-level desc. : Maximize the multivariate Gaussian integral over a polytope, evaluated using Genz&#39;s algorithm, and optimize the nonlinear (log-concave) problem using MATLAB&#39;s patternsearch Approximation : Approximate upto a user-specified tolerance Controller type : Open-loop controller that satisfies the hard input bounds Optimality : Optimal open-loop controller for the underapproximation problem due to convexity guarantees Dependency (MATLAB): Global Optimization toolbox (for patternsearch) SReachTool function: SReachPointGpO Paper : A. Vinod and M. Oishi, &quot;Scalable Underapproximation for Stochastic Reach-Avoid Problem for High-Dimensional LTI Systems using Fourier Transforms,&quot; in IEEE Control Systems Letters, 2017. 5. Particle control approach (particle-open): High-level desc. : Sample particles based on the additive noise and solve a mixed-integer linear program to make the maximum number of particles satisfy the reachability objective Approximation : No direct approximation guarantees. Accuracy improves as the number of particles considered increases. Controller type : Open-loop controller that satisfies the hard input bounds Optimality : Optimal (w.r.t particles drawn) open-loop controller for the underapproximation problem Dependency (EXT) : CVX, Gurobi SReachTool function: SReachPointPaO Paper : K. Lesser, M. Oishi, and R. Erwin, &quot;Stochastic reachability for control of spacecraft relative motion,&quot; In Proc. IEEE Conf. Dec. &amp; Ctrl., 2013. 6. Particle control-based approach with undersampling via Voronoi partitions (voronoi-open): High-level desc. : Sample particles based on the additive noise and solve a mixed-integer linear program to make the maximum number of particles satisfy the reachability objective In addition, we use Voronoi partition to drastically improve the tractability while preserving the underapproximation quality Approximation : Overapproximation bounded above (in probability) by a user-specified tolerance Controller type : Open-loop controller that satisfies the hard input bounds Optimality : Optimal (w.r.t particles drawn) open-loop controller for the underapproximation problem Dependency (EXT) : CVX, Gurobi SReachTool function: SReachPointVoO Paper : H. Sartipizadeh, A. Vinod, B. Acikmese, and M. Oishi, &quot;Voronoi Partition-based Scenario Reduction for Fast Sampling-based Stochastic Reachability Computation of LTI Systems&quot;, In Proc. Amer. Ctrl. Conf., 2019 See also examples/cwhSReachPointDemo.m and examples/dubinsSReachPointDemo.m. ============================================================================= [approx_reach_prob, opt_input_vec, opt_input_gain] = SReachPoint(prob_str,... method_str, sys, initial_state, safety_tube, [options]) Inputs: ------- prob_str - String specifying the problem of interest. For each case, we compute the optimal value function that maps initial states to different maximal reach probabilities 1. &#39;term&#39; : Stay within the safety_tube method_str - Solution technique to be used. &#39;chance-open&#39; -- Convex chance-constrained approach for an open-loop controller synthesis; performs risk allocation and controller synthesis simultaneously &#39;chance-affine&#39;-- Difference-of-convex chance-constrained approach for an affine controller synthesis; Allocates risk and synthesizes controller simultaneously &#39;chance-affine-uni&#39; -- Uniform risk allocation approach for an affine controller synthesis; Decouples the risk allocation problem from controller synthesis &#39;genzps-open&#39; -- Genz&#39;s algorithm + Patternsearch for an open-loop controller synthesis &#39;particle-open&#39;-- Particle control-based approach for an open-loop controller synthesis &#39;voronoi-open&#39; -- Voronoi undersampling of Particle control-based approach for an open-loop controller synthesis sys - System description (LtvSystem/LtiSystem object) initial_state- Initial state for which the maximal reach probability must be evaluated (A numeric vector of dimension sys.state_dim) safety_tube - Collection of (potentially time-varying) safe sets that define the safe states (Tube object) options - [Optional] Collection of user-specified options for each of the solution (Matlab struct created using SReachPointOptions) Outputs: -------- approx_reach_prob - Approximation (underapproximation, in some cases) to the stochastic reach problem opt_input_vec, opt_input_gain - Controller U=MW+d for a concatenated input vector U = [u_0; u_1; ...; u_{N-1}] and concatenated disturbance vector W=[w_0; w_1; ...; w_{N-1}]. - opt_input_gain: Affine controller gain matrix of dimension (sys.input_dim*N) x (sys.dist_dim*N) - opt_input_vec: Open-loop controller: column vector dimension (sys.input_dim*N) x 1 The feedback gain matrix M is set to [] for methods that look for open-loop controllers. risk_alloc_state - [Available only for &#39;chance-X&#39;] Risk allocation for the state constraints risk_alloc_input - [Available only for &#39;chance-affine(-X)&#39;] Risk allocation for the input constraints extra_info - [Available only for &#39;voronoi-X&#39;] MATLAB struct containing additional info about the Voronoi partition-based undersampling used for tractable particle control approach Notes: * SReachPoint() will call SReachPointOptions() internally if SReachPointOptions()-based options is not explicitly provided to SReachPoint(). This will set the algorithm to default options. * &#39;chance-affine&#39; and &#39;chance-affine-uni&#39; requires an explicit declaration of the options from SReachPointOptions() to specify the threshold on the chance-constraint relaxation of the input bounds. * &#39;chance-affine&#39; provides the best lower bound at the cost of additional compute time, when compared to &#39;chance-affine-uni&#39; * See @LtiSystem/getConcatMats for more information about the notation used. * If an open_loop policy is desired arranged in increasing time columnwise, use the following command: optimal_open_loop_control_policy = reshape(opt_controller, ... sys.input_dim, time_horizon); ============================================================================= This function is part of the Stochastic Reachability Toolbox. License for the use of this function is given in https://github.com/unm-hscl/SReachTools/blob/master/LICENSE" />
<meta property="og:description" content="Solve the problem of stochastic reachability of a target tube from a given initial state using a host of techniques ============================================================================= SReachPoint can (approximately) solve the problem of stochastic reachability of a target tube from a given initial state, maximize Prob( \cap_{i=1}^N x_t lies in Safe_t) subject to dynamics and bounds on control This function can compute an underapproximation to the optimal value of the above problem as well as synthesize controllers: 1. open-loop controller that satisfies the prespecified hard control bounds, 2. affine disturbance feedback controller that satisfies the hard control bounds with a likelihood above the user-specified threshold. This function is a compilation of various techniques proposed in the literature. The problem of stochastic reachability of a target tube is discussed in A. Vinod and M. Oishi, &quot;Stochastic reachability of a target tube: Theory and computation,&quot; IEEE Transactions in Automatic Control, 2018 (submitted) URL: https://arxiv.org/pdf/1810.05217.pdf. It subsumes the terminal hitting-time stochastic reach-avoid problem (Summers and Lygeros, Automatica, 2010) as well as the stochastic viability problem (Abate et. al, Automatica, 2008). This function is a compilation of various techniques proposed in the literature: 1. Convex chance-constrained-based approach (chance-open): High-level desc. : Use Boole&#39;s inequality, Gaussian random vector, and piecewise linear approximation of the inverse of the standard normal cumulative density function to create a linear program-based approximation to the original optimization Approximation : Guaranteed underapproximation Controller type : Open-loop controller that satisfies the hard input bounds Optimality : Optimal open-loop controller for the underapproximation problem due to convexity guarantees SReachTool function: SReachPointCcO Dependency (EXT) : CVX Paper : a. K. Lesser, M. Oishi, and R. Erwin, &quot;Stochastic reachability for control of spacecraft relative motion,&quot; In Proc. IEEE Conf. Dec. &amp; Ctrl., 2013. b. A. Vinod and M. Oishi. Affine controller synthesis for stochastic reachability via difference of convex programming. In Proc. Conf. of Dec. &amp; Ctrl., 2019. (submitted). https://hscl.unm.edu/affinecontrollersynthesis/ 2. Difference-of-convex chance-constrained-based approach (chance-affine): High-level desc. : Use Boole&#39;s inequality, Gaussian random vector, hyperbolic constraints-to-second order cone constraint reformulation, and piecewise linear approximation of the inverse of the standard normal cumulative density function to create a second-order cone program-based difference-of-convex optimization problem Controller type : A history-dependent affine controller that satisfies softened input constraints (controller satisfies the hard input bounds upto a user-specified probabilistic threshold) Optimality : Suboptimal affine controller for the underapproximation problem due to non-convexity established by the difference of convex formulation Approximation : Guaranteed underapproximation SReachTool function: SReachPointCcA Dependency (EXT) : CVX Paper : A. Vinod and M. Oishi. Affine controller synthesis for stochastic reachability via difference of convex programming. In Proc. Conf. of Dec. &amp; Ctrl., 2019. (submitted). https://hscl.unm.edu/affinecontrollersynthesis/ 3. Uniform risk allocation-based approach (chance-affine-uni): High-level desc. : Use Boole&#39;s inequality, Gaussian random vector, hyperbolic constraints-to-second order cone constraint reformulation. By decoupling the risk allocation from controller synthesis, this approach solves a series of SOCP problems guided by a bisection on the uniform risk allocation (See Notes) Controller type : A history-dependent affine controller that satisfies softened input constraints (controller satisfies the hard input bounds upto a user-specified probabilistic threshold) Optimality : Suboptimal affine controller for the underapproximation problem Approximation : Guaranteed underapproximation SReachTool function: SReachPointCcAu Dependency (EXT) : CVX Paper : 1) M. Vitus and C. Tomlin, &quot;On feedback design and risk allocation in chance constrained control&quot;, In Proc. Conf. Dec. &amp; Ctrl., 2011. 2) A. Vinod and M. Oishi. Affine controller synthesis for stochastic reachability via difference of convex programming. In Proc. Conf. of Dec. &amp; Ctrl., 2019 (submitted). https://hscl.unm.edu/affinecontrollersynthesis/ 4. Fourier transform + Patternsearch (genzps-open): High-level desc. : Maximize the multivariate Gaussian integral over a polytope, evaluated using Genz&#39;s algorithm, and optimize the nonlinear (log-concave) problem using MATLAB&#39;s patternsearch Approximation : Approximate upto a user-specified tolerance Controller type : Open-loop controller that satisfies the hard input bounds Optimality : Optimal open-loop controller for the underapproximation problem due to convexity guarantees Dependency (MATLAB): Global Optimization toolbox (for patternsearch) SReachTool function: SReachPointGpO Paper : A. Vinod and M. Oishi, &quot;Scalable Underapproximation for Stochastic Reach-Avoid Problem for High-Dimensional LTI Systems using Fourier Transforms,&quot; in IEEE Control Systems Letters, 2017. 5. Particle control approach (particle-open): High-level desc. : Sample particles based on the additive noise and solve a mixed-integer linear program to make the maximum number of particles satisfy the reachability objective Approximation : No direct approximation guarantees. Accuracy improves as the number of particles considered increases. Controller type : Open-loop controller that satisfies the hard input bounds Optimality : Optimal (w.r.t particles drawn) open-loop controller for the underapproximation problem Dependency (EXT) : CVX, Gurobi SReachTool function: SReachPointPaO Paper : K. Lesser, M. Oishi, and R. Erwin, &quot;Stochastic reachability for control of spacecraft relative motion,&quot; In Proc. IEEE Conf. Dec. &amp; Ctrl., 2013. 6. Particle control-based approach with undersampling via Voronoi partitions (voronoi-open): High-level desc. : Sample particles based on the additive noise and solve a mixed-integer linear program to make the maximum number of particles satisfy the reachability objective In addition, we use Voronoi partition to drastically improve the tractability while preserving the underapproximation quality Approximation : Overapproximation bounded above (in probability) by a user-specified tolerance Controller type : Open-loop controller that satisfies the hard input bounds Optimality : Optimal (w.r.t particles drawn) open-loop controller for the underapproximation problem Dependency (EXT) : CVX, Gurobi SReachTool function: SReachPointVoO Paper : H. Sartipizadeh, A. Vinod, B. Acikmese, and M. Oishi, &quot;Voronoi Partition-based Scenario Reduction for Fast Sampling-based Stochastic Reachability Computation of LTI Systems&quot;, In Proc. Amer. Ctrl. Conf., 2019 See also examples/cwhSReachPointDemo.m and examples/dubinsSReachPointDemo.m. ============================================================================= [approx_reach_prob, opt_input_vec, opt_input_gain] = SReachPoint(prob_str,... method_str, sys, initial_state, safety_tube, [options]) Inputs: ------- prob_str - String specifying the problem of interest. For each case, we compute the optimal value function that maps initial states to different maximal reach probabilities 1. &#39;term&#39; : Stay within the safety_tube method_str - Solution technique to be used. &#39;chance-open&#39; -- Convex chance-constrained approach for an open-loop controller synthesis; performs risk allocation and controller synthesis simultaneously &#39;chance-affine&#39;-- Difference-of-convex chance-constrained approach for an affine controller synthesis; Allocates risk and synthesizes controller simultaneously &#39;chance-affine-uni&#39; -- Uniform risk allocation approach for an affine controller synthesis; Decouples the risk allocation problem from controller synthesis &#39;genzps-open&#39; -- Genz&#39;s algorithm + Patternsearch for an open-loop controller synthesis &#39;particle-open&#39;-- Particle control-based approach for an open-loop controller synthesis &#39;voronoi-open&#39; -- Voronoi undersampling of Particle control-based approach for an open-loop controller synthesis sys - System description (LtvSystem/LtiSystem object) initial_state- Initial state for which the maximal reach probability must be evaluated (A numeric vector of dimension sys.state_dim) safety_tube - Collection of (potentially time-varying) safe sets that define the safe states (Tube object) options - [Optional] Collection of user-specified options for each of the solution (Matlab struct created using SReachPointOptions) Outputs: -------- approx_reach_prob - Approximation (underapproximation, in some cases) to the stochastic reach problem opt_input_vec, opt_input_gain - Controller U=MW+d for a concatenated input vector U = [u_0; u_1; ...; u_{N-1}] and concatenated disturbance vector W=[w_0; w_1; ...; w_{N-1}]. - opt_input_gain: Affine controller gain matrix of dimension (sys.input_dim*N) x (sys.dist_dim*N) - opt_input_vec: Open-loop controller: column vector dimension (sys.input_dim*N) x 1 The feedback gain matrix M is set to [] for methods that look for open-loop controllers. risk_alloc_state - [Available only for &#39;chance-X&#39;] Risk allocation for the state constraints risk_alloc_input - [Available only for &#39;chance-affine(-X)&#39;] Risk allocation for the input constraints extra_info - [Available only for &#39;voronoi-X&#39;] MATLAB struct containing additional info about the Voronoi partition-based undersampling used for tractable particle control approach Notes: * SReachPoint() will call SReachPointOptions() internally if SReachPointOptions()-based options is not explicitly provided to SReachPoint(). This will set the algorithm to default options. * &#39;chance-affine&#39; and &#39;chance-affine-uni&#39; requires an explicit declaration of the options from SReachPointOptions() to specify the threshold on the chance-constraint relaxation of the input bounds. * &#39;chance-affine&#39; provides the best lower bound at the cost of additional compute time, when compared to &#39;chance-affine-uni&#39; * See @LtiSystem/getConcatMats for more information about the notation used. * If an open_loop policy is desired arranged in increasing time columnwise, use the following command: optimal_open_loop_control_policy = reshape(opt_controller, ... sys.input_dim, time_horizon); ============================================================================= This function is part of the Stochastic Reachability Toolbox. License for the use of this function is given in https://github.com/unm-hscl/SReachTools/blob/master/LICENSE" />
<link rel="canonical" href="http://localhost:4000/docs/src/modules/stochReach/pointBased/SReachPoint/" />
<meta property="og:url" content="http://localhost:4000/docs/src/modules/stochReach/pointBased/SReachPoint/" />
<meta property="og:site_name" content="SReachTools" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-04-18T13:49:56-04:00" />
<script type="application/ld+json">
{"headline":"SReachPoint.m","dateModified":"2019-04-18T13:49:56-04:00","datePublished":"2019-04-18T13:49:56-04:00","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/docs/src/modules/stochReach/pointBased/SReachPoint/"},"url":"http://localhost:4000/docs/src/modules/stochReach/pointBased/SReachPoint/","description":"Solve the problem of stochastic reachability of a target tube from a given initial state using a host of techniques ============================================================================= SReachPoint can (approximately) solve the problem of stochastic reachability of a target tube from a given initial state, maximize Prob( \\cap_{i=1}^N x_t lies in Safe_t) subject to dynamics and bounds on control This function can compute an underapproximation to the optimal value of the above problem as well as synthesize controllers: 1. open-loop controller that satisfies the prespecified hard control bounds, 2. affine disturbance feedback controller that satisfies the hard control bounds with a likelihood above the user-specified threshold. This function is a compilation of various techniques proposed in the literature. The problem of stochastic reachability of a target tube is discussed in A. Vinod and M. Oishi, &quot;Stochastic reachability of a target tube: Theory and computation,&quot; IEEE Transactions in Automatic Control, 2018 (submitted) URL: https://arxiv.org/pdf/1810.05217.pdf. It subsumes the terminal hitting-time stochastic reach-avoid problem (Summers and Lygeros, Automatica, 2010) as well as the stochastic viability problem (Abate et. al, Automatica, 2008). This function is a compilation of various techniques proposed in the literature: 1. Convex chance-constrained-based approach (chance-open): High-level desc. : Use Boole&#39;s inequality, Gaussian random vector, and piecewise linear approximation of the inverse of the standard normal cumulative density function to create a linear program-based approximation to the original optimization Approximation : Guaranteed underapproximation Controller type : Open-loop controller that satisfies the hard input bounds Optimality : Optimal open-loop controller for the underapproximation problem due to convexity guarantees SReachTool function: SReachPointCcO Dependency (EXT) : CVX Paper : a. K. Lesser, M. Oishi, and R. Erwin, &quot;Stochastic reachability for control of spacecraft relative motion,&quot; In Proc. IEEE Conf. Dec. &amp; Ctrl., 2013. b. A. Vinod and M. Oishi. Affine controller synthesis for stochastic reachability via difference of convex programming. In Proc. Conf. of Dec. &amp; Ctrl., 2019. (submitted). https://hscl.unm.edu/affinecontrollersynthesis/ 2. Difference-of-convex chance-constrained-based approach (chance-affine): High-level desc. : Use Boole&#39;s inequality, Gaussian random vector, hyperbolic constraints-to-second order cone constraint reformulation, and piecewise linear approximation of the inverse of the standard normal cumulative density function to create a second-order cone program-based difference-of-convex optimization problem Controller type : A history-dependent affine controller that satisfies softened input constraints (controller satisfies the hard input bounds upto a user-specified probabilistic threshold) Optimality : Suboptimal affine controller for the underapproximation problem due to non-convexity established by the difference of convex formulation Approximation : Guaranteed underapproximation SReachTool function: SReachPointCcA Dependency (EXT) : CVX Paper : A. Vinod and M. Oishi. Affine controller synthesis for stochastic reachability via difference of convex programming. In Proc. Conf. of Dec. &amp; Ctrl., 2019. (submitted). https://hscl.unm.edu/affinecontrollersynthesis/ 3. Uniform risk allocation-based approach (chance-affine-uni): High-level desc. : Use Boole&#39;s inequality, Gaussian random vector, hyperbolic constraints-to-second order cone constraint reformulation. By decoupling the risk allocation from controller synthesis, this approach solves a series of SOCP problems guided by a bisection on the uniform risk allocation (See Notes) Controller type : A history-dependent affine controller that satisfies softened input constraints (controller satisfies the hard input bounds upto a user-specified probabilistic threshold) Optimality : Suboptimal affine controller for the underapproximation problem Approximation : Guaranteed underapproximation SReachTool function: SReachPointCcAu Dependency (EXT) : CVX Paper : 1) M. Vitus and C. Tomlin, &quot;On feedback design and risk allocation in chance constrained control&quot;, In Proc. Conf. Dec. &amp; Ctrl., 2011. 2) A. Vinod and M. Oishi. Affine controller synthesis for stochastic reachability via difference of convex programming. In Proc. Conf. of Dec. &amp; Ctrl., 2019 (submitted). https://hscl.unm.edu/affinecontrollersynthesis/ 4. Fourier transform + Patternsearch (genzps-open): High-level desc. : Maximize the multivariate Gaussian integral over a polytope, evaluated using Genz&#39;s algorithm, and optimize the nonlinear (log-concave) problem using MATLAB&#39;s patternsearch Approximation : Approximate upto a user-specified tolerance Controller type : Open-loop controller that satisfies the hard input bounds Optimality : Optimal open-loop controller for the underapproximation problem due to convexity guarantees Dependency (MATLAB): Global Optimization toolbox (for patternsearch) SReachTool function: SReachPointGpO Paper : A. Vinod and M. Oishi, &quot;Scalable Underapproximation for Stochastic Reach-Avoid Problem for High-Dimensional LTI Systems using Fourier Transforms,&quot; in IEEE Control Systems Letters, 2017. 5. Particle control approach (particle-open): High-level desc. : Sample particles based on the additive noise and solve a mixed-integer linear program to make the maximum number of particles satisfy the reachability objective Approximation : No direct approximation guarantees. Accuracy improves as the number of particles considered increases. Controller type : Open-loop controller that satisfies the hard input bounds Optimality : Optimal (w.r.t particles drawn) open-loop controller for the underapproximation problem Dependency (EXT) : CVX, Gurobi SReachTool function: SReachPointPaO Paper : K. Lesser, M. Oishi, and R. Erwin, &quot;Stochastic reachability for control of spacecraft relative motion,&quot; In Proc. IEEE Conf. Dec. &amp; Ctrl., 2013. 6. Particle control-based approach with undersampling via Voronoi partitions (voronoi-open): High-level desc. : Sample particles based on the additive noise and solve a mixed-integer linear program to make the maximum number of particles satisfy the reachability objective In addition, we use Voronoi partition to drastically improve the tractability while preserving the underapproximation quality Approximation : Overapproximation bounded above (in probability) by a user-specified tolerance Controller type : Open-loop controller that satisfies the hard input bounds Optimality : Optimal (w.r.t particles drawn) open-loop controller for the underapproximation problem Dependency (EXT) : CVX, Gurobi SReachTool function: SReachPointVoO Paper : H. Sartipizadeh, A. Vinod, B. Acikmese, and M. Oishi, &quot;Voronoi Partition-based Scenario Reduction for Fast Sampling-based Stochastic Reachability Computation of LTI Systems&quot;, In Proc. Amer. Ctrl. Conf., 2019 See also examples/cwhSReachPointDemo.m and examples/dubinsSReachPointDemo.m. ============================================================================= [approx_reach_prob, opt_input_vec, opt_input_gain] = SReachPoint(prob_str,... method_str, sys, initial_state, safety_tube, [options]) Inputs: ------- prob_str - String specifying the problem of interest. For each case, we compute the optimal value function that maps initial states to different maximal reach probabilities 1. &#39;term&#39; : Stay within the safety_tube method_str - Solution technique to be used. &#39;chance-open&#39; -- Convex chance-constrained approach for an open-loop controller synthesis; performs risk allocation and controller synthesis simultaneously &#39;chance-affine&#39;-- Difference-of-convex chance-constrained approach for an affine controller synthesis; Allocates risk and synthesizes controller simultaneously &#39;chance-affine-uni&#39; -- Uniform risk allocation approach for an affine controller synthesis; Decouples the risk allocation problem from controller synthesis &#39;genzps-open&#39; -- Genz&#39;s algorithm + Patternsearch for an open-loop controller synthesis &#39;particle-open&#39;-- Particle control-based approach for an open-loop controller synthesis &#39;voronoi-open&#39; -- Voronoi undersampling of Particle control-based approach for an open-loop controller synthesis sys - System description (LtvSystem/LtiSystem object) initial_state- Initial state for which the maximal reach probability must be evaluated (A numeric vector of dimension sys.state_dim) safety_tube - Collection of (potentially time-varying) safe sets that define the safe states (Tube object) options - [Optional] Collection of user-specified options for each of the solution (Matlab struct created using SReachPointOptions) Outputs: -------- approx_reach_prob - Approximation (underapproximation, in some cases) to the stochastic reach problem opt_input_vec, opt_input_gain - Controller U=MW+d for a concatenated input vector U = [u_0; u_1; ...; u_{N-1}] and concatenated disturbance vector W=[w_0; w_1; ...; w_{N-1}]. - opt_input_gain: Affine controller gain matrix of dimension (sys.input_dim*N) x (sys.dist_dim*N) - opt_input_vec: Open-loop controller: column vector dimension (sys.input_dim*N) x 1 The feedback gain matrix M is set to [] for methods that look for open-loop controllers. risk_alloc_state - [Available only for &#39;chance-X&#39;] Risk allocation for the state constraints risk_alloc_input - [Available only for &#39;chance-affine(-X)&#39;] Risk allocation for the input constraints extra_info - [Available only for &#39;voronoi-X&#39;] MATLAB struct containing additional info about the Voronoi partition-based undersampling used for tractable particle control approach Notes: * SReachPoint() will call SReachPointOptions() internally if SReachPointOptions()-based options is not explicitly provided to SReachPoint(). This will set the algorithm to default options. * &#39;chance-affine&#39; and &#39;chance-affine-uni&#39; requires an explicit declaration of the options from SReachPointOptions() to specify the threshold on the chance-constraint relaxation of the input bounds. * &#39;chance-affine&#39; provides the best lower bound at the cost of additional compute time, when compared to &#39;chance-affine-uni&#39; * See @LtiSystem/getConcatMats for more information about the notation used. * If an open_loop policy is desired arranged in increasing time columnwise, use the following command: optimal_open_loop_control_policy = reshape(opt_controller, ... sys.input_dim, time_horizon); ============================================================================= This function is part of the Stochastic Reachability Toolbox. License for the use of this function is given in https://github.com/unm-hscl/SReachTools/blob/master/LICENSE","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="SReachTools" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">SReachTools</a>
    <div style="float: left; padding-top: 9px; padding-left: 15px; height: 45px;">
      <a href="https://github.com/sreachtools/SReachTools" style="line-height: 54px;">
        <svg viewBox="0 0 16 16" width="30px" height="30px"><path fill="#ffffff" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
      </a>
    </div><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger">
<!--<a class="page-link" href="/blog/">Blog Posts</a><a class="page-link" href="/contributing/">Contributing Guidelines</a><a class="page-link" href="/docs/">Documentation</a><a class="page-link" href="/examples/">Examples</a><a class="page-link" href="/">Stochastic Reachability Toolbox for MATLAB</a><a class="page-link" href="/installation.html">Dependencies &amp; Installation</a><a class="page-link" href="/license/">Licenses</a><a class="page-link" href="/long_description.html">Stochastic Reachability Toolbox</a>-->
            <a class="page-link" href="/">Home</a>
            <a class="page-link" href="/installation">Installation</a>
            <!-- <a class="page-link" href="/about">About</a> -->
            <a class="page-link" href="/docs">Docs</a>
            <a class="page-link" href="/examples">Examples</a>
            <a class="page-link" href="/license">Licenses</a>
            <!-- <a class="page-link" href="/contact">Contact</a> -->
        </div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">SReachPoint.m</h1>
  </header>

  <div class="post-content">
    <div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  Solve the problem of stochastic reachability of a target tube from a given
  initial state using a host of techniques
  =============================================================================
 
  SReachPoint can (approximately) solve the problem of stochastic reachability 
  of a target tube from a given initial state,
 
      maximize Prob( \cap_{i=1}^N x_t lies in Safe_t)
      subject to
            dynamics and bounds on control
 
  This function can compute an underapproximation to the optimal value of the
  above problem as well as synthesize controllers:
  1. open-loop controller that satisfies the prespecified hard control bounds,
  2. affine disturbance feedback controller that satisfies the hard control
        bounds with a likelihood above the user-specified threshold.
  This function is a compilation of various techniques proposed in the
  literature.
 
  The problem of stochastic reachability of a target tube is discussed in 
 
  A. Vinod and M. Oishi, "Stochastic reachability of a target tube: Theory and
  computation," IEEE Transactions in Automatic Control, 2018 (submitted) URL:
  https://arxiv.org/pdf/1810.05217.pdf.
 
  It subsumes the terminal hitting-time stochastic reach-avoid problem (Summers
  and Lygeros, Automatica, 2010) as well as the stochastic viability problem
  (Abate et. al, Automatica, 2008).
 
  This function is a compilation of various techniques proposed in the
  literature:
 
  1. Convex chance-constrained-based approach (chance-open):
 
     High-level desc.   : Use Boole's inequality, Gaussian random vector, and
                          piecewise linear approximation of the inverse of the
                          standard normal cumulative density function to create
                          a linear program-based approximation to the original
                          optimization
     Approximation      : Guaranteed underapproximation
     Controller type    : Open-loop controller that satisfies the hard
                          input bounds 
     Optimality         : Optimal open-loop controller for the
                          underapproximation problem due to convexity guarantees
     SReachTool function: SReachPointCcO
     Dependency (EXT)   : CVX
     Paper              : a. K. Lesser, M. Oishi, and R. Erwin, "Stochastic
                             reachability for control of spacecraft relative
                             motion," In Proc. IEEE Conf. Dec. &amp; Ctrl., 2013.
                          b. A. Vinod and M. Oishi. Affine controller synthesis
                             for stochastic reachability via difference of
                             convex programming. In Proc. Conf. of Dec. &amp; Ctrl.,
                             2019. (submitted).
                             https://hscl.unm.edu/affinecontrollersynthesis/
 
  2. Difference-of-convex chance-constrained-based approach (chance-affine):
 
     High-level desc.   : Use Boole's inequality, Gaussian random vector,
                          hyperbolic constraints-to-second order cone constraint
                          reformulation, and piecewise linear approximation of
                          the inverse of the standard normal cumulative density
                          function to create a second-order cone program-based
                          difference-of-convex optimization problem
     Controller type    : A history-dependent affine controller that satisfies
                          softened input constraints (controller satisfies the
                          hard input bounds upto a user-specified probabilistic
                          threshold)
     Optimality         : Suboptimal affine controller for the
                          underapproximation problem due to non-convexity
                          established by the difference of convex formulation
     Approximation      : Guaranteed underapproximation
     SReachTool function: SReachPointCcA
     Dependency (EXT)   : CVX
     Paper              : A. Vinod and M. Oishi. Affine controller synthesis for
                          stochastic reachability via difference of convex
                          programming. In Proc. Conf. of Dec. &amp; Ctrl., 2019.
                          (submitted).
                          https://hscl.unm.edu/affinecontrollersynthesis/
 
  3. Uniform risk allocation-based approach (chance-affine-uni):
 
     High-level desc.   : Use Boole's inequality, Gaussian random vector,
                          hyperbolic constraints-to-second order cone constraint
                          reformulation. By decoupling the risk allocation
                          from controller synthesis, this approach solves a
                          series of SOCP problems guided by a bisection on
                          the uniform risk allocation (See Notes)
     Controller type    : A history-dependent affine controller that satisfies
                          softened input constraints (controller satisfies the
                          hard input bounds upto a user-specified probabilistic
                          threshold)
     Optimality         : Suboptimal affine controller for the
                          underapproximation problem
     Approximation      : Guaranteed underapproximation
     SReachTool function: SReachPointCcAu
     Dependency (EXT)   : CVX
     Paper              : 1) M. Vitus and C. Tomlin, "On feedback design and 
                             risk allocation in chance constrained control", In 
                             Proc. Conf. Dec. &amp; Ctrl., 2011.
                          2) A. Vinod and M. Oishi. Affine controller synthesis
                             for stochastic reachability via difference of 
                             convex programming. In Proc. Conf. of Dec. &amp; Ctrl., 
                             2019 (submitted).
                             https://hscl.unm.edu/affinecontrollersynthesis/
 
  4. Fourier transform + Patternsearch (genzps-open):
 
     High-level desc.   : Maximize the multivariate Gaussian integral over a
                          polytope, evaluated using Genz's algorithm, and
                          optimize the nonlinear (log-concave) problem using
                          MATLAB's patternsearch
     Approximation      : Approximate upto a user-specified tolerance
     Controller type    : Open-loop controller that satisfies the hard input
                          bounds
     Optimality         : Optimal open-loop controller for the
                          underapproximation problem due to convexity guarantees
     Dependency (MATLAB): Global Optimization toolbox (for patternsearch)
     SReachTool function: SReachPointGpO
     Paper              : A. Vinod and M. Oishi, "Scalable Underapproximation
                          for Stochastic Reach-Avoid Problem for
                          High-Dimensional LTI Systems using Fourier
                          Transforms," in IEEE Control Systems Letters, 2017.
 
  5. Particle control approach (particle-open):
 
     High-level desc.   : Sample particles based on the additive noise and solve
                          a mixed-integer linear program to make the maximum
                          number of particles satisfy the reachability objective
     Approximation      : No direct approximation guarantees. Accuracy improves
                          as the number of particles considered increases.
     Controller type    : Open-loop controller that satisfies the hard input
                          bounds
     Optimality         : Optimal (w.r.t particles drawn) open-loop controller
                          for the underapproximation problem 
     Dependency (EXT)   : CVX, Gurobi
     SReachTool function: SReachPointPaO
     Paper              : K. Lesser, M. Oishi, and R. Erwin, "Stochastic
                          reachability for control of spacecraft relative
                          motion," In Proc. IEEE Conf. Dec. &amp; Ctrl., 2013.
 
  6. Particle control-based approach with undersampling via Voronoi partitions 
     (voronoi-open):
 
     High-level desc.   : Sample particles based on the additive noise and solve
                          a mixed-integer linear program to make the maximum
                          number of particles satisfy the reachability objective
                          In addition, we use Voronoi partition to
                          drastically improve the tractability while
                          preserving the underapproximation quality
     Approximation      : Overapproximation bounded above (in probability) by a
                          user-specified tolerance
     Controller type    : Open-loop controller that satisfies the hard input
                          bounds
     Optimality         : Optimal (w.r.t particles drawn) open-loop controller
                          for the underapproximation problem 
     Dependency (EXT)   : CVX, Gurobi
     SReachTool function: SReachPointVoO
     Paper              : H. Sartipizadeh, A. Vinod, B. Acikmese, and M. Oishi, 
                          "Voronoi Partition-based Scenario Reduction for Fast 
                          Sampling-based Stochastic Reachability Computation of
                          LTI Systems", In Proc. Amer. Ctrl. Conf., 2019
 
  See also examples/cwhSReachPointDemo.m and examples/dubinsSReachPointDemo.m.
 
  =============================================================================
 
  [approx_reach_prob, opt_input_vec, opt_input_gain] = SReachPoint(prob_str,...
    method_str, sys, initial_state, safety_tube, [options])
  
  Inputs:
  -------
    prob_str     - String specifying the problem of interest. For each case, we
                   compute the optimal value function that maps initial states
                   to different maximal reach probabilities
                       1. 'term' : Stay within the safety_tube
    method_str   - Solution technique to be used.
                       'chance-open'  -- Convex chance-constrained approach for
                                         an open-loop controller synthesis;
                                         performs risk allocation and
                                         controller synthesis
                                         simultaneously
                       'chance-affine'-- Difference-of-convex chance-constrained 
                                         approach for an affine controller 
                                         synthesis; Allocates risk and 
                                         synthesizes controller simultaneously
                       'chance-affine-uni'
                                      -- Uniform risk allocation approach for an 
                                         affine controller synthesis; Decouples
                                         the risk allocation problem from
                                         controller synthesis
                       'genzps-open'  -- Genz's algorithm + Patternsearch for an
                                         open-loop controller synthesis
                       'particle-open'-- Particle control-based approach for an
                                         open-loop controller synthesis
                       'voronoi-open' -- Voronoi undersampling of Particle
                                         control-based approach for an open-loop
                                         controller synthesis
    sys          - System description (LtvSystem/LtiSystem object)
    initial_state- Initial state for which the maximal reach probability must be
                   evaluated (A numeric vector of dimension sys.state_dim)
    safety_tube  - Collection of (potentially time-varying) safe sets that
                   define the safe states (Tube object)
    options      - [Optional] Collection of user-specified options for each of
                   the solution (Matlab struct created using SReachPointOptions)
 
  Outputs:
  --------
    approx_reach_prob 
                - Approximation (underapproximation, in some cases) to the
                  stochastic reach problem
    opt_input_vec, 
      opt_input_gain
                - Controller U=MW+d for a concatenated input vector 
                    U = [u_0; u_1; ...; u_{N-1}] and concatenated disturbance
                    vector W=[w_0; w_1; ...; w_{N-1}]. 
                    - opt_input_gain: Affine controller gain matrix of dimension
                        (sys.input_dim*N) x (sys.dist_dim*N)
                    - opt_input_vec: Open-loop controller: column vector 
                      dimension
                        (sys.input_dim*N) x 1
                  The feedback gain matrix M is set to [] for methods that look
                  for open-loop controllers. 
    risk_alloc_state 
                - [Available only for 'chance-X'] Risk allocation for the
                  state constraints
    risk_alloc_input
                - [Available only for 'chance-affine(-X)'] Risk allocation for 
                  the input constraints
    extra_info  - [Available only for 'voronoi-X'] MATLAB struct
                  containing additional info about the Voronoi partition-based 
                  undersampling used for tractable particle control approach
 
  Notes:
  * SReachPoint() will call SReachPointOptions() internally if
        SReachPointOptions()-based options is not explicitly provided to
        SReachPoint(). This will set the algorithm to default options.
  * 'chance-affine' and 'chance-affine-uni' requires an explicit declaration of 
    the options from SReachPointOptions() to specify the threshold on the 
    chance-constraint relaxation of the input bounds.
  * 'chance-affine' provides the best lower bound at the cost of additional
    compute time, when compared to 'chance-affine-uni'
  * See @LtiSystem/getConcatMats for more information about the notation used.
  * If an open_loop policy is desired arranged in increasing time columnwise,
    use the following command:
        optimal_open_loop_control_policy = reshape(opt_controller, ...
            sys.input_dim, time_horizon);
  
  =============================================================================
  
  This function is part of the Stochastic Reachability Toolbox.
  License for the use of this function is given in
       https://github.com/unm-hscl/SReachTools/blob/master/LICENSE
 
 
</code></pre></div></div>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">
    <div class="footer-col-wrapper">
      <div style="text-align: center;">
          <p>&copy 2019 <a href="https://abyvinod.github.io">Abraham P. Vinod</a>, <a href="https://unm.edu/~gleasonj">Joseph D. Gleason</a>, and <a href="https://unm.edu/~oishi" target="_blank">Meeko M. K. Oishi</a></p>
          <!--<p><a href="https://hscl.unm.edu/">Hybrid Systems and Control Lab, UNM</a></p>-->
          <p><a href="/installation">SReachTools Installation Page</a></p>
        <p>Powered by <a href="https://jekyllrb.com/">Jekyll</a>; theme modified from <a href="https://github.com/jekyll/minima">Jekyll minima</a></p>
      </div>
  </div>

</footer>
</body>

</html>
